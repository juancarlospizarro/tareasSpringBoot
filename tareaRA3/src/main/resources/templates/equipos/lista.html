<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Listado de Equipos</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.13.1/font/bootstrap-icons.min.css">
</head>
<body class="bg-light">

<div class="container mt-5">

    <div class="d-flex justify-content-between align-items-center mb-4">
        <h1>Listado de Equipos</h1>
		<div class="d-flex justify-content-between align-items-center">
			<a th:href="@{/equipos/nuevo}" class="btn btn-success mx-2">
	            Añadir equipo
	        </a>
			<form th:action="@{/logout}" method="post">
	            <button type="submit" class="btn btn-outline-danger mx-3">
	                Cerrar sesión
	            </button>
	        </form>
		</div>
        
    </div>
	<form th:action="@{/equipos}" method="get" class="row g-2 mb-4">
						    <div class="col-md-2">
						        <input type="text" name="nombre" class="form-control" placeholder="Buscar por nombre"				               th:value="${nombre}">
						    </div>
						    <div class="col-md-1">
						        <button type="submit" class="btn btn-primary w-100">
						            Buscar
						        </button>
						    </div>
						    <div class="col-md-1">
						        <a th:href="@{/equipos}" class="btn btn-secondary w-100">
						            Borrar
						        </a>
						    </div>
						</form>

    <div class="card shadow">
        <div class="card-body">
            <table class="table table-striped table-hover align-middle">
                <thead class="table-dark">
                    <tr>
                        <th>Nombre</th>
                        <th>Año de fundación</th>
                        <th>Ciudad</th>
                        <th class="text-center">Acciones</th>
                    </tr>
                </thead>
                <tbody>
                    <tr th:each="equipo : ${equipos}">
                        <td th:text="${equipo.nombre}"></td>
                        <td th:text="${equipo.anio_fundacion}"></td>
                        <td th:text="${equipo.ciudad}"></td>
                        <td class="text-center">
							<a th:href="@{/equipos/{id}(id=${equipo.id})}"
							   class="btn btn-sm btn-secondary me-2 text-white">
							    Detalles
							</a>
                            <a th:href="@{/equipos/{id}/editar(id=${equipo.id})}" 
                               class="btn btn-sm btn-warning me-2">
                                Editar
                            </a>
							<button type="button" class="btn btn-sm btn-danger" data-bs-toggle="modal"
							        th:attr="data-bs-target='#modalEliminar-' + ${equipo.id}">
								Eliminar
							</button>
							<div class="modal fade"
							     th:id="'modalEliminar-' + ${equipo.id}"
							     tabindex="-1">
							    <div class="modal-dialog">
							        <div class="modal-content">

							            <div class="modal-header bg-danger text-white">
							                <h5 class="modal-title">Confirmar eliminación</h5>
							                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
							            </div>

							            <div class="modal-body">
							                ¿Seguro que deseas eliminar el equipo
							                <strong th:text="${equipo.nombre}"></strong>?
							            </div>

							            <div class="modal-footer">
							                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
							                    Cancelar
							                </button>

							                <form th:action="@{/equipos/{id}/eliminar(id=${equipo.id})}" method="post">
							                    <button type="submit" class="btn btn-danger">
							                        Eliminar
							                    </button>
							                </form>
							            </div>

							        </div>
							    </div>
							</div>
                        </td>
                    </tr>
                </tbody>
            </table>
			<!-- Controles de paginación -->
			<div>
				<nav aria-label="Paginación de equipos">
			    <ul class="pagination justify-content-center">

			        <!-- Enlace "Inicio" -->
					<li class="page-item" th:classappend="${equipos.first} ? 'disabled'">
					    <a class="page-link"
					       th:href="@{/equipos(nombre=${nombre}, page=0)}">
					        Inicio
					    </a>
					</li>

					<li class="page-item" th:classappend="${!equipos.hasPrevious()} ? 'disabled'">
					    <a class="page-link"
					       th:href="@{/equipos(nombre=${nombre}, page=${equipos.number - 1})}">
					        <i class="bi bi-caret-left-square-fill"></i> Anterior
					    </a>
					</li>
					
					<!-- Enlace a la página anterior a la actual, si existe -->
					<li th:if="${equipos.number > 1}" class="page-item">
					    <a th:href="@{/equipos(nombre=${nombreBusqueda}, page=${equipos.number - 2})}"
					       class="page-link"
					       th:text="${equipos.number - 1}">
					    </a>
					</li>

					<!-- Enlace a la página actual -->
					<li class="page-item active">
					    <a th:href="@{/equipos(nombre=${nombreBusqueda}, page=${equipos.number})}"
					       class="page-link"
					       th:text="${equipos.number + 1}">
					    </a>
					</li>

					<!-- Enlace a la página siguiente a la actual, si existe -->
					<li th:if="${equipos.number + 1 < equipos.totalPages}" class="page-item">
					    <a th:href="@{/equipos(nombre=${nombreBusqueda}, page=${equipos.number + 1})}"
					       class="page-link"
					       th:text="${equipos.number + 2}">
					    </a>
					</li>

			        <!-- Enlace "Siguiente" -->
					<li class="page-item" th:classappend="${!equipos.hasNext()} ? 'disabled'">
					    <a class="page-link"
					       th:href="@{/equipos(nombre=${nombre}, page=${equipos.number + 1})}">
					        Siguiente <i class="bi bi-caret-right-square-fill"></i>
					    </a>
					</li>

					<li class="page-item" th:classappend="${equipos.last} ? 'disabled'">
					    <a class="page-link"
					       th:href="@{/equipos(nombre=${nombre}, page=${equipos.totalPages - 1})}">
					        Fin
					    </a>
					</li>

			    </ul>
				</nav>
				<p class="text-center text-muted mt-2">
				    Página <strong th:text="${equipos.number + 1}"></strong>
				    de <strong th:text="${equipos.totalPages}"></strong>
				</p>
			</div>
			
			

			
        </div>
    </div>
</div>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
